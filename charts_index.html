<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Token Price Charts - –ò–Ω–¥–µ–∫—Å</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #0e1117;
            color: #fafafa;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }
        h1 {
            color: #00cc96;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        .stats {
            margin-bottom: 40px;
            padding: 20px;
            background-color: #262730;
            border-radius: 8px;
            border: 1px solid #404040;
        }
        .pages-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .page-card {
            background-color: #262730;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #404040;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .page-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
        }
        .page-card a {
            color: #00cc96;
            text-decoration: none;
            font-size: 1.2em;
            font-weight: bold;
        }
        .page-card a:hover {
            color: #00a876;
        }
        .page-info {
            color: #888;
            margin-top: 10px;
            font-size: 14px;
        }
        .back-home {
            margin-top: 40px;
        }
        .back-home a {
            background-color: #00cc96;
            color: white;
            text-decoration: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            display: inline-block;
            transition: background-color 0.3s;
        }
        .back-home a:hover {
            background-color: #00a876;
        }
        .search-container {
            margin: 30px 0;
            padding: 25px;
            background-color: #262730;
            border-radius: 12px;
            border: 1px solid #404040;
        }
        .search-title {
            color: #00cc96;
            margin-bottom: 15px;
            font-size: 1.3em;
            font-weight: bold;
        }
        .search-input {
            width: 100%;
            padding: 12px 15px;
            background-color: #1a1a1a;
            border: 2px solid #404040;
            border-radius: 8px;
            color: #fafafa;
            font-size: 16px;
            box-sizing: border-box;
            transition: border-color 0.3s;
        }
        .search-input:focus {
            outline: none;
            border-color: #00cc96;
        }
        .search-input::placeholder {
            color: #888;
        }
        .search-button {
            background-color: #00cc96;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
            transition: background-color 0.3s;
        }
        .search-button:hover {
            background-color: #00a876;
        }
        .search-button:disabled {
            background-color: #555;
            cursor: not-allowed;
        }
        .search-result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }
        .search-result.success {
            background-color: rgba(0, 204, 150, 0.1);
            border: 1px solid #00cc96;
            color: #00cc96;
        }
        .search-result.error {
            background-color: rgba(255, 107, 107, 0.1);
            border: 1px solid #ff6b6b;
            color: #ff6b6b;
        }
        .token-info {
            margin-top: 10px;
            color: #fafafa;
        }
        .token-link {
            display: inline-block;
            margin-top: 10px;
            background-color: #00cc96;
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        .token-link:hover {
            background-color: #00a876;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìà Token Price Charts</h1>
        
        <!-- Search Container -->
        <div class="search-container">
            <div class="search-title">üîç –ü–æ–∏—Å–∫ —Ç–æ–∫–µ–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É</div>
            <input
                type="text"
                id="tokenSearch"
                class="search-input"
                placeholder="–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å —Ç–æ–∫–µ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: GyEJPVTVVdBURwMWZNKF3ifjJ4Pj4Q4nFV3DTcnHg59d)"
                maxlength="50"
            >
            <button id="searchButton" class="search-button">–ù–∞–π—Ç–∏ —Ç–æ–∫–µ–Ω</button>
            <div id="searchResult" class="search-result"></div>
        </div>
        
        <div class="stats">
            <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <p>–í—Å–µ–≥–æ –≥—Ä–∞—Ñ–∏–∫–æ–≤: <strong>30</strong></p>
            <p>–°—Ç—Ä–∞–Ω–∏—Ü: <strong>6</strong></p>
            <p>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ: <strong>06.07.2025 14:03:39</strong></p>
        </div>
        
        <div class="pages-grid">
            <div class="page-card">
                <a href="charts_page_1.html">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1</a>
                <div class="page-info">
                    –ì—Ä–∞—Ñ–∏–∫–∏ 1-5
                </div>
            </div>
            <div class="page-card">
                <a href="charts_page_2.html">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 2</a>
                <div class="page-info">
                    –ì—Ä–∞—Ñ–∏–∫–∏ 6-10
                </div>
            </div>
            <div class="page-card">
                <a href="charts_page_3.html">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 3</a>
                <div class="page-info">
                    –ì—Ä–∞—Ñ–∏–∫–∏ 11-15
                </div>
            </div>
            <div class="page-card">
                <a href="charts_page_4.html">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 4</a>
                <div class="page-info">
                    –ì—Ä–∞—Ñ–∏–∫–∏ 16-20
                </div>
            </div>
            <div class="page-card">
                <a href="charts_page_5.html">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 5</a>
                <div class="page-info">
                    –ì—Ä–∞—Ñ–∏–∫–∏ 21-25
                </div>
            </div>
            <div class="page-card">
                <a href="charts_page_6.html">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 6</a>
                <div class="page-info">
                    –ì—Ä–∞—Ñ–∏–∫–∏ 26-30
                </div>
            </div>
        </div>
        
        <div class="back-home">
            <a href="index.html">‚Üê –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</a>
        </div>
    </div>

    <script>
        let tokensData = null;
        
        // Load tokens data
        async function loadTokensData() {
            try {
                console.log('Attempting to load tokens data from: processed_tokens.json');
                const response = await fetch('processed_tokens.json');
                console.log('Response status:', response.status, response.statusText);
                if (response.ok) {
                    tokensData = await response.json();
                    console.log('Tokens data loaded successfully:', Object.keys(tokensData.tokens || {}).length, 'tokens');
                    console.log('Sample token data:', Object.values(tokensData.tokens)[0]);
                } else {
                    console.error('Failed to load tokens data. Status:', response.status, response.statusText);
                }
            } catch (error) {
                console.error('Error loading tokens data:', error);
            }
        }
        
        // Validate Solana address format (basic check)
        function isValidSolanaAddress(address) {
            // Basic Solana address validation: 32-44 characters, base58
            const base58Regex = /^[1-9A-HJ-NP-Za-km-z]{32,44}$/;
            return base58Regex.test(address);
        }
        
        // Find chart page for token
        function findTokenChartPage(tokenAddress) {
            if (!tokensData || !tokensData.tokens) {
                return 'charts_page_1.html'; // fallback
            }
            
            // Get all token addresses in order they were processed
            const tokenEntries = Object.entries(tokensData.tokens)
                .sort((a, b) => new Date(a[1].processed_at) - new Date(b[1].processed_at));
            
            // Find the index of our token
            const tokenIndex = tokenEntries.findIndex(([key, token]) =>
                token.token_address === tokenAddress
            );
            
            if (tokenIndex === -1) {
                return 'charts_page_1.html'; // fallback if not found
            }
            
            // Calculate page number (assuming 5 charts per page)
            const chartsPerPage = 5;
            const pageNumber = Math.floor(tokenIndex / chartsPerPage) + 1;
            
            return `charts_page_${pageNumber}.html`;
        }
        
        // Search for token by address
        function searchToken() {
            const searchInput = document.getElementById('tokenSearch');
            const searchResult = document.getElementById('searchResult');
            const searchButton = document.getElementById('searchButton');
            
            const address = searchInput.value.trim();
            
            // Clear previous results
            searchResult.style.display = 'none';
            searchResult.className = 'search-result';
            
            // Validate input
            if (!address) {
                showSearchResult('error', '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å —Ç–æ–∫–µ–Ω–∞');
                return;
            }
            
            // Validate Solana address format
            if (!isValidSolanaAddress(address)) {
                showSearchResult('error', '–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∞–¥—Ä–µ—Å–∞ Solana. –ê–¥—Ä–µ—Å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 32-44 —Å–∏–º–≤–æ–ª–∞ –∏ —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ base58.');
                return;
            }
            
            // Check if tokens data is loaded
            if (!tokensData || !tokensData.tokens) {
                showSearchResult('error', '–î–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω–æ–≤ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
                return;
            }
            
            // Search for token
            let foundToken = null;
            let foundKey = null;
            
            // First try exact address match
            for (const [key, token] of Object.entries(tokensData.tokens)) {
                if (token.token_address === address) {
                    foundToken = token;
                    foundKey = key;
                    break;
                }
            }
            
            // If not found by exact address, try partial address match
            if (!foundToken) {
                for (const [key, token] of Object.entries(tokensData.tokens)) {
                    // Check if address starts with input
                    if (token.token_address.toLowerCase().startsWith(address.toLowerCase())) {
                        foundToken = token;
                        foundKey = key;
                        break;
                    }
                }
            }
            
            if (foundToken) {
                const tokenName = foundToken.token_name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                const processedDate = new Date(foundToken.processed_at).toLocaleString('ru-RU');
                const chartPage = findTokenChartPage(foundToken.token_address);
                
                showSearchResult('success',
                    `‚úÖ –¢–æ–∫–µ–Ω –Ω–∞–π–¥–µ–Ω!`,
                    `<div class="token-info">
                        <strong>–ù–∞–∑–≤–∞–Ω–∏–µ:</strong> ${tokenName}<br>
                        <strong>–ê–¥—Ä–µ—Å:</strong> ${foundToken.token_address}<br>
                        <strong>–û–±—Ä–∞–±–æ—Ç–∞–Ω:</strong> ${processedDate}
                    </div>
                    <a href="${chartPage}#${foundToken.token_address}" class="token-link">–ü–µ—Ä–µ–π—Ç–∏ –∫ –≥—Ä–∞—Ñ–∏–∫—É</a>`
                );
            } else {
                showSearchResult('error', '–¢–æ–∫–µ–Ω —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∞–¥—Ä–µ—Å–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.');
            }
        }
        
        // Show search result
        function showSearchResult(type, message, additionalContent = '') {
            const searchResult = document.getElementById('searchResult');
            searchResult.className = `search-result ${type}`;
            searchResult.innerHTML = message + additionalContent;
            searchResult.style.display = 'block';
        }
        
        // Initialize page
        window.addEventListener('load', function() {
            loadTokensData();
            
            // Add event listeners
            const searchButton = document.getElementById('searchButton');
            const searchInput = document.getElementById('tokenSearch');
            
            if (searchButton && searchInput) {
                searchButton.addEventListener('click', searchToken);
                
                // Allow search on Enter key
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        searchToken();
                    }
                });
            }
        });
    </script>
</body>
</html>